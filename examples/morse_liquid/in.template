units metal
atom_style atomic
boundary p p p

read_data ../init.data

mass * 63.55

TABLESTYLE
TABLECOEFF

timestep       0.001


dump           1 all custom  1000 funcder_1.dump id type x y z vx vy vz
restart        500000 funcder_1.*.rst


### VISCOSITY SECTION ###
variable    T equal 1500
variable    p equal 200     # correlation length
variable    s equal 5       # sample interval
variable    d equal $p*$s   # dump interval

variable         pxy equal pxy
variable         pxx equal pxx-press
variable         scale equal 1.0/$T*vol*$s*dt
variable         diagfac equal 2-2/3

fix              SS all ave/correlate $s $p $d v_pxy v_pxx type auto 

variable         viscosity equal 0.5*(trap(f_SS[3])+trap(f_SS[4])/${diagfac})*${scale}



### THERMAL CONDUCTIVITY SECTION ###
compute         KE all ke/atom
compute         PE all pe/atom
compute         Stress all stress/atom NULL virial
compute         flux all heat/flux KE PE Stress

fix             JJ all ave/correlate $s $p $d &
                c_flux[1] c_flux[2] c_flux[3] type auto

variable        scale equal $s*dt/$T/$T/vol
variable        thermalcond equal (trap(f_JJ[3])+trap(f_JJ[4])+trap(f_JJ[5]))*${scale}/3



### DIFFUSION COEFFICIENT SECTION ###
### incompatible time steps
compute         vacf all vacf
fix             5 all vector 1 c_vacf[4]
variable        diffcoeff equal 1/3*dt*trap(f_5)



velocity all create $T SEED rot yes dist gaussian

fix 1 all nvt temp $T $T 0.1

thermo_style   custom step cpu etotal pe ke temp vol press pxx pyy pzz pxy pxz pyz lx ly lz xy xz yz v_viscosity v_thermalcond v_diffcoeff
thermo 1000

compute RDF_2000 all rdf 2000
fix RDFout_2000 all ave/time 1 1 1000 c_RDF_2000[*] file funcder_1_2000.rdf mode vector
compute RDF_total all rdf 2000
fix RDFout_total all ave/time 1000 2000 2000000  c_RDF_total[*] file funcder_1_total.rdf mode vector

run 2000000 

